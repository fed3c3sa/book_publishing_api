<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{{ title }}</title>
    <style>
        @page {
            size: {{ page_size }};
            margin: {{ margin }}cm; /* Consider reducing {{ margin }} value if it's too large, e.g., 1.5cm or 2cm */
            @top-center {
                content: {% if show_page_numbers %}"Page " counter(page){% else %}''{% endif %};
                font-family: {{ font_family }}, Arial, sans-serif; /* Added fallback fonts */
                font-size: 9pt; /* Slightly smaller for a cleaner footer/header */
                color: #666; /* Softer color for page numbers */
            }
        }
        body {
            font-family: {{ font_family }}, Verdana, Geneva, sans-serif; /* Added fallback fonts */
            font-size: {{ font_size }}pt;
            line-height: 1.55; /* Slightly adjusted for readability and space */
            color: {{ text_color }};
            background-color: {{ background_color }};
            /* text-align: left; /* Consider for younger kids as justify can create large gaps. Or keep justify if preferred. */
        }
        .book-title {
            font-size: {{ title_font_size }}pt; /* Ensure this is large enough, e.g., 36pt or more */
            font-weight: bold;
            text-align: center;
            margin-top: 20%; /* Reduced from 30% to lessen blank space */
            margin-bottom: 1cm; /* Added bottom margin for spacing before cover image */
            color: {{ title_color }};
            text-shadow: 2px 2px 4px rgba(0,0,0,0.1); /* Subtle shadow for depth */
        }
        .cover-image {
            display: block;
            margin: 1cm auto 2cm auto; /* Reduced top margin */
            max-width: 75%; /* Slightly reduced if you want more text space around, or keep at 80% */
            max-height: 55%; /* Adjusted slightly */
            height: auto; /* Ensures aspect ratio is maintained */
            object-fit: contain; /* Ensures entire image is visible within bounds */
            border-radius: 10px; /* Softer, more modern rounded corners */
            box-shadow: 0 6px 12px rgba(0,0,0,0.15); /* Enhanced shadow */
        }
        .chapter {
            page-break-before: always;
            padding-top: 0.5cm; /* Add a little space at the top of the chapter page, if not covered by header margin */
        }
        .chapter-title {
            font-size: {{ chapter_title_font_size }}pt; /* Ensure this is impactful, e.g., 24pt or more */
            font-weight: bold;
            text-align: center;
            margin-top: 1cm; /* Reduced from 2cm */
            margin-bottom: 1cm; /* Reduced from 1.5cm */
            color: {{ chapter_title_color }};
            padding-bottom: 0.3cm; /* Reduced from 0.5cm */
            border-bottom: 3px solid {{ chapter_title_color }}; /* Made border slightly thicker */
            /* Consider more creative borders in theme-specific styles */
        }
        .paragraph {
            text-indent: 1.5em;
            margin-bottom: 0.8em; /* Reduced from 1em to tighten paragraphs */
            text-align: justify; /* Keep if desired, but be mindful of gaps for young readers */
            line-height: 1.6; /* Ensure good readability within paragraphs */
        }
        .image-container {
            margin: 1cm auto; /* Reduced from 1.5cm */
            text-align: center;
        }
        .image-container.float-right {
            float: right;
            margin: 0.2cm 0 0.5cm 0.8cm; /* Adjusted margins for tighter wrap */
            max-width: 45%; /* Slightly increased for impact, adjust as needed */
        }
        .image-container.float-left {
            float: left;
            margin: 0.2cm 0.8cm 0.5cm 0; /* Adjusted margins for tighter wrap */
            max-width: 45%; /* Slightly increased for impact, adjust as needed */
        }
        .image {
            max-width: 100%;
            height: auto; /* Crucial for responsive images */
            border-radius: 8px; /* Consistent rounded corners */
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.15); /* Softer, more modern shadow */
            display: block; /* Prevents extra space below image if it's inline */
        }
        .image-caption {
            font-style: italic;
            font-size: 0.85em; /* Slightly smaller for distinction */
            margin-top: 0.4em; /* Reduced margin */
            text-align: center;
            color: #555; /* Softer color for captions */
        }
        .page-break {
            page-break-after: always;
        }
        .decorative-border {
            border: {{ border_width }}px {{ border_style }} {{ border_color }};
            padding: 0.8cm; /* Reduced from 1cm */
            margin: 0.8cm 0; /* Adjusted margin */
            border-radius: {{ border_radius }}px; /* e.g. 10px or 15px for a softer look */
            /* Background color for decorative border will be handled in themes */
        }
        .clearfix::after {
            content: "";
            clear: both;
            display: table;
        }

        /* Styles for text_with_image block */
        .text-with-image-block .paragraph {
             /* Allow text to flow naturally around the floated image container */
        }

        {% block additional_styles %}{% endblock %}
    </style>
</head>
<body>
    {% block content %}{% endblock %}
</body>
</html>